<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kashvi's 18th | The Final Build ðŸ§¿</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;800&family=Playfair+Display:ital,wght@0,400;1,700&family=Fira+Code:wght@300;500&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/",
            "ogl": "https://unpkg.com/ogl@0.0.114/dist/ogl.mjs"
        }
    }
    </script>
    
    <style>
        :root { --primary-blue: #00d4ff; --neon-pink: #ffb7c5; --deep-space: #010103; --gold: #ffd700; --cyber-alert: #ff0055; }
        body { margin: 0; padding: 0; background: var(--deep-space); font-family: 'Inter', sans-serif; color: white; overflow: hidden; scroll-behavior: smooth; user-select: none; -webkit-tap-highlight-color: transparent; }

        /* --- LOCK SCREEN --- */
        #overlay { position: fixed; inset: 0; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 2000; background: radial-gradient(circle at center, rgba(0, 29, 61, 0.9) 0%, #000000 100%); transition: opacity 1.2s cubic-bezier(0.4, 0, 0.2, 1); }
        #secret-trigger { letter-spacing: 8px; color: var(--primary-blue); font-weight: bold; margin-bottom: 30px; cursor: pointer; font-size: 0.9rem; text-shadow: 0 0 10px var(--primary-blue); font-family: 'Fira Code'; }
        
        .system-logs { font-family: 'Fira Code', monospace; font-size: 0.7rem; color: var(--primary-blue); line-height: 1.8; text-align: left; display: inline-block; min-height: 140px; width: 280px; }
        .log-hint { color: var(--cyber-alert); font-weight: bold; text-shadow: 0 0 8px var(--cyber-alert); animation: flicker 2s infinite; }
        @keyframes flicker { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        #countdown { display: flex; margin-bottom: 30px; gap: 10px; justify-content: center; }
        .timer-unit { text-align: center; min-width: 65px; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px; border: 1px solid rgba(0, 212, 255, 0.2); transition: 0.5s; }
        .timer-num { font-size: 1.8rem; font-weight: 800; color: var(--primary-blue); display: block; font-family: 'Fira Code'; font-variant-numeric: tabular-nums; }
        .timer-label { font-size: 0.55rem; letter-spacing: 2px; opacity: 0.7; }

        .entry-btn { padding: 15px 40px; border-radius: 50px; background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.2); font-size: 0.7rem; letter-spacing: 2px; font-family: 'Fira Code'; cursor: not-allowed; transition: 0.5s; pointer-events: none; }
        .entry-btn.ready { background: rgba(0, 212, 255, 0.1); border: 1px solid var(--primary-blue); color: white; cursor: pointer; pointer-events: auto; box-shadow: 0 0 20px rgba(0, 212, 255, 0.3); }

        /* --- CONTENT --- */
        #canvas-container { position: fixed; inset: 0; z-index: 1; pointer-events: none; }
        .content-scroll { position: relative; z-index: 10; width: 100%; display: none; flex-direction: column; align-items: center; height: 100vh; overflow-y: scroll; }
        .container { text-align: center; padding: 15vh 0 0 0; width: 100%; max-width: 100vw; overflow-x: hidden; }
        
        /* --- 3D GALLERY --- */
        #gallery-wrapper { width: 100vw; height: 550px; position: relative; margin: 40px 0; cursor: grab; }
        #circular-gallery-container { width: 100%; height: 100%; }

        /* --- FINALE --- */
        #finale-section { display: none; width: 100%; padding-bottom: 100px; padding-top: 50px; }
        .cake-box { height: 350px; position: relative; margin: 50px auto; width: 250px; }
        .layer { position: absolute; left: 50%; transform: translate(-50%, -1000px); border-radius: 50% / 25px; transition: 1.2s cubic-bezier(0.17, 0.67, 0.25, 1); }
        .l1 { bottom: 0; width: 220px; height: 90px; background: #5d4037; border-top: 5px solid #795548; }
        .l2 { bottom: 75px; width: 170px; height: 80px; background: #ff4d6d; border-top: 5px solid #ff758f; }
        .l3 { bottom: 140px; width: 120px; height: 65px; background: #fff9c4; border-top: 5px solid #ffffff; }
        .candle-stick { bottom: 195px; width: 12px; height: 50px; background: repeating-linear-gradient(45deg, var(--primary-blue), var(--primary-blue) 6px, #fff 6px, #fff 12px); left: 50%; transform: translate(-50%, -1000px); border-radius: 5px; }
        .flame { position: absolute; top: -28px; left: 50%; transform: translateX(-50%); width: 20px; height: 35px; background: radial-gradient(circle at center, #ffd700, #ff8c00, transparent); border-radius: 50% 50% 20% 20%; filter: blur(1px); animation: burn 0.2s infinite alternate; }
        @keyframes burn { from { transform: translateX(-50%) scale(1); } to { transform: translateX(-50%) scale(1.1); } }

        /* --- SCRATCH --- */
        .scratch-wrap { display: none; margin: 50px auto; opacity: 0; transition: 1s; width: 320px; position: relative; }
        #scratchCanvas { position: absolute; top: 0; left: 0; border-radius: 15px; touch-action: none; cursor: crosshair; z-index: 100; }
        .scratch-content { width: 320px; height: 180px; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #050505; color: var(--gold); border: 1px solid var(--gold); border-radius: 15px; font-family: 'Playfair Display'; font-style: italic; text-align: center; padding: 25px; box-sizing: border-box; }

        .system-popup { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); background: rgba(0, 15, 30, 0.98); border: 1px solid var(--primary-blue); padding: 25px; z-index: 3000; font-family: 'Fira Code', monospace; border-radius: 15px; transition: 0.3s; width: 250px; }
        .system-popup.active { transform: translate(-50%, -50%) scale(1); }
        #goldenStar { position: fixed; top: 5%; right: 5%; width: 40px; height: 40px; cursor: pointer; z-index: 500; display: none; align-items: center; justify-content: center; }
        .star-dot { width: 6px; height: 6px; background: var(--gold); border-radius: 50%; box-shadow: 0 0 15px var(--gold); animation: starPulse 1.5s infinite; }
        @keyframes starPulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(2); opacity: 0.4; } }
    </style>
</head>
<body>

<div id="overlay">
    <div id="secret-trigger" onclick="checkPass()">[ CHAPTER 18 ]</div>
    <div class="system-logs" id="logContainer"></div>
    <div id="countdown">
        <div class="timer-unit" id="tu-d"><span class="timer-num" id="days">00</span><span class="timer-label">DAYS</span></div>
        <div class="timer-unit" id="tu-h"><span class="timer-num" id="hours">00</span><span class="timer-label">HRS</span></div>
        <div class="timer-unit" id="tu-m"><span class="timer-num" id="mins">00</span><span class="timer-label">MINS</span></div>
        <div class="timer-unit" id="tu-s"><span class="timer-num" id="secs">00</span><span class="timer-label">SECS</span></div>
    </div>
    <button id="entryBtn" class="entry-btn">SYSTEM_LOCKED ðŸ”’</button>
</div>

<div id="starPopup" class="system-popup">
    <div style="font-size: 0.55rem; color: var(--neon-pink); margin-bottom: 12px;">> RECOVERY_DATA</div>
    <div id="popupBody" style="color: var(--primary-blue); font-size: 0.85rem;"></div>
    <button onclick="closePopup()" style="margin-top:20px; background:none; border:1px solid var(--primary-blue); color:white; width:100%; padding:5px; font-family:'Fira Code';">EXIT</button>
</div>

<div id="goldenStar" onclick="revealStarMsg()"><div class="star-dot"></div></div>
<div id="canvas-container"></div>

<div class="content-scroll" id="mainContent">
    <div class="container">
        <h1 id="k-title" onclick="kEasterEgg()" style="font-size: 3.5rem; font-family: 'Playfair Display'; font-style: italic; margin-bottom: 5px; cursor: pointer;">Kashvi</h1>
        <div id="override-msg" style="display:none; color:var(--neon-pink); font-family:'Fira Code'; font-size:0.6rem; margin-bottom: 20px;">OVERRIDE: PARTNER_STABILITY_100% ðŸ§¿</div>
        
        <div id="gallery-wrapper">
            <div id="circular-gallery-container"></div>
        </div>

        <div id="finale-section">
            <div class="cake-box">
                <div class="layer l1" id="layer1"></div>
                <div class="layer l2" id="layer2"></div>
                <div class="layer l3" id="layer3"></div>
                <div class="layer candle-stick" id="candle"><div class="flame"></div></div>
            </div>
            
            <h2 style="font-family: 'Playfair Display'; font-size: 2.5rem; color: var(--primary-blue); margin-bottom: 20px;">Happy 18th! ðŸ§¿</h2>
            <div style="font-family: 'Inter'; font-weight: 800; color: var(--neon-pink); letter-spacing: 2px; font-size: 1.2rem; margin-bottom: 40px;">THE BEST IS YET TO COME.</div>

            <div class="scratch-wrap" id="scratchWrap">
                <div class="scratch-content">
                    "May your 18th year be your most powerful build yet."
                    <span style="font-family:'Inter'; font-size:0.7rem; color:var(--neon-pink); margin-top:15px; letter-spacing:2px;">STABILITY: PERFECT ðŸ§¿ðŸ’™</span>
                </div>
                <canvas id="scratchCanvas" width="320" height="180"></canvas>
            </div>
        </div>
    </div>
</div>

<audio id="bgMusic" loop><source src="birthday-song.mp3" type="audio/mpeg"></audio>

<script>
    const logs = ["> Booting Life_Modules...", "> Compiling School_Memories...", "> [!] HINT: Click title 5x", "> [!] KEY: KASHVI18"];
    let logIdx = 0;
    function typeLogs() {
        if (logIdx < logs.length) {
            let div = document.createElement('div');
            if(logIdx >= 2) div.className = "log-hint";
            document.getElementById('logContainer').appendChild(div);
            let i = 0;
            let t = setInterval(() => {
                if(i < logs[logIdx].length) div.innerHTML += logs[logIdx][i++];
                else { clearInterval(t); logIdx++; setTimeout(typeLogs, 500); }
            }, 30);
        }
    }
    typeLogs();

    const target = new Date("January 20, 2026 00:00:00").getTime();
    function updateTimer() {
        const diff = target - Date.now();
        document.getElementById('days').innerText = String(Math.max(0, Math.floor(diff/86400000))).padStart(2,'0');
        document.getElementById('hours').innerText = String(Math.max(0, Math.floor((diff%86400000)/3600000))).padStart(2,'0');
        document.getElementById('mins').innerText = String(Math.max(0, Math.floor((diff%3600000)/60000))).padStart(2,'0');
        document.getElementById('secs').innerText = String(Math.max(0, Math.floor((diff%60000)/1000))).padStart(2,'0');
        if (diff <= 0) {
            const btn = document.getElementById('entryBtn');
            btn.innerHTML = "ENTER THE GALAXY ðŸ§¿";
            btn.classList.add('ready');
            btn.onclick = unlock;
        }
    }
    setInterval(updateTimer, 1000);

    function animateCountUp(id, to) {
        let curr = 0;
        const el = document.getElementById(id);
        const tu = document.getElementById('tu-' + id[0]);
        tu.style.transform = 'scale(1.2)';
        tu.style.borderColor = '#00d4ff';
        const timer = setInterval(() => {
            if (curr >= to) { clearInterval(timer); el.textContent = String(to).padStart(2,'0'); tu.style.transform='scale(1)'; }
            else { curr++; el.textContent = String(curr).padStart(2,'0'); }
        }, 50);
    }

    function checkPass() { if(prompt("ACCESS KEY:").toUpperCase() === "KASHVI18") unlock(); }

    function unlock() {
        document.getElementById('bgMusic').play().catch(()=>{});
        animateCountUp('days', 18);
        document.getElementById('overlay').style.opacity = '0';
        setTimeout(() => { 
            document.getElementById('overlay').style.display = 'none'; 
            document.getElementById('mainContent').style.display = 'flex';
            document.getElementById('goldenStar').style.display = 'flex';
            document.body.style.overflowY = 'auto';
            triggerFinaleScrollObserver();
        }, 1200);
    }

    function triggerFinaleScrollObserver() {
        const observer = new IntersectionObserver((entries) => {
            if(entries[0].isIntersecting) {
                ['layer1', 'layer2', 'layer3', 'candle'].forEach((id, i) => {
                    setTimeout(() => { document.getElementById(id).style.transform = 'translate(-50%, 0)'; }, i * 600);
                });
                setTimeout(initScratch, 3000);
            }
        }, { threshold: 0.1 });
        observer.observe(document.getElementById('finale-section'));
    }

    function initScratch() {
        const wrap = document.getElementById('scratchWrap');
        wrap.style.display = 'block'; setTimeout(()=>wrap.style.opacity='1',100);
        const canvas = document.getElementById('scratchCanvas'), ctx = canvas.getContext('2d');
        ctx.fillStyle = '#1a1a1a'; ctx.fillRect(0,0,320,180);
        ctx.fillStyle = '#888'; ctx.font = "12px Fira Code"; ctx.textAlign = 'center'; ctx.fillText('SCRATCH TO REVEAL FINAL MODULE', 160, 95);
        let drawing = false;
        const scratch = (e) => {
            if(!drawing) return;
            const r = canvas.getBoundingClientRect();
            const x = (e.pageX || e.touches[0].pageX) - r.left;
            const y = (e.pageY || e.touches[0].pageY) - r.top;
            ctx.globalCompositeOperation = 'destination-out';
            ctx.beginPath(); ctx.arc(x, y, 25, 0, 6.28); ctx.fill();
        };
        canvas.addEventListener('mousedown', () => drawing = true);
        canvas.addEventListener('touchstart', (e) => { drawing = true; e.preventDefault(); });
        window.addEventListener('mouseup', () => drawing = false);
        canvas.addEventListener('mousemove', scratch);
        canvas.addEventListener('touchmove', scratch);
    }

    let kCount = 0;
    function kEasterEgg() { if(++kCount === 5) { window.glowPink(); document.getElementById('override-msg').style.display = 'block'; } }
    function revealStarMsg() { 
        const msgs = ["LOG: Stability Check 100%", "DATA: Legend in the making", "ENCRYPTION: ðŸ§¿ðŸ’™"];
        document.getElementById('popupBody').innerText = msgs[Math.floor(Math.random()*msgs.length)];
        document.getElementById('starPopup').classList.add('active'); 
    }
    function closePopup() { document.getElementById('starPopup').classList.remove('active'); }
</script>

<script type="module">
    import * as THREE from 'three';
    import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
    import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
    import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';
    import { Renderer, Camera, Transform, Plane, Program, Mesh, Texture } from 'ogl';

    // --- THREE.JS BACKGROUND ---
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    camera.position.z = 30;
    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.getElementById('canvas-container').appendChild(renderer.domElement);

    const bloom = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
    const composer = new EffectComposer(renderer);
    composer.addPass(new RenderPass(scene, camera));
    composer.addPass(bloom);

    const count = 8000, geo = new THREE.BufferGeometry(), pos = new Float32Array(count * 3);
    for(let i=0; i<count*3; i++) pos[i] = (Math.random()-0.5)*100;
    geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));
    const mat = new THREE.PointsMaterial({ size: 0.1, color: 0x00d4ff });
    const points = new THREE.Points(geo, mat); scene.add(points);

    window.glowPink = () => { mat.color.set(0xffb7c5); bloom.strength = 3; };

    function animBG() {
        requestAnimationFrame(animBG);
        points.rotation.y += 0.001;
        composer.render();
    }
    animBG();

    // --- OGL 3D GALLERY ---
    const galContainer = document.getElementById('circular-gallery-container');
    const oglRenderer = new Renderer({ alpha: true, antialias: true });
    const gl = oglRenderer.gl;
    galContainer.appendChild(gl.canvas);
    const oglCamera = new Camera(gl, { fov: 45 });
    oglCamera.position.z = 20;
    const oglScene = new Transform();

    const mediaData = [
        {img: "1.jpeg"}, {img: "2.jpeg"}, {img: "7.jpeg"}, 
        {img: "8.jpeg"}, {img: "9.jpeg"}, {img: "10.jpeg"}
    ].concat([{img: "1.jpeg"}, {img: "2.jpeg"}, {img: "7.jpeg"}, {img: "8.jpeg"}, {img: "9.jpeg"}, {img: "10.jpeg"}]);

    const planeGeo = new Plane(gl, {heightSegments:20, widthSegments:20});
    const medias = mediaData.map((data, i) => {
        const tex = new Texture(gl);
        const img = new Image(); img.src = data.img; img.onload = () => tex.image = img;
        const prog = new Program(gl, {
            vertex: `attribute vec3 position; attribute vec2 uv; uniform mat4 modelViewMatrix; uniform mat4 projectionMatrix; varying vec2 vUv; void main() { vUv = uv; vec3 p = position; p.z = sin(p.x * 0.5); gl_Position = projectionMatrix * modelViewMatrix * vec4(p, 1.0); }`,
            fragment: `precision highp float; uniform sampler2D tMap; varying vec2 vUv; void main() { gl_FragColor = texture2D(tMap, vUv); }`,
            uniforms: { tMap: { value: tex } }
        });
        const mesh = new Mesh(gl, { geometry: planeGeo, program: prog });
        mesh.scale.set(7, 10, 1);
        mesh.setParent(oglScene);
        return { mesh, i };
    });

    let scroll = 0, targetScroll = 0;
    galContainer.addEventListener('mousedown', e => { galContainer.isDown = true; galContainer.startX = e.clientX; });
    window.addEventListener('mousemove', e => { 
        if(!galContainer.isDown) return;
        targetScroll += (galContainer.startX - e.clientX) * 0.05;
        galContainer.startX = e.clientX;
    });
    window.addEventListener('mouseup', () => galContainer.isDown = false);
    // Touch support
    galContainer.addEventListener('touchstart', e => { galContainer.isDown = true; galContainer.startX = e.touches[0].clientX; });
    galContainer.addEventListener('touchmove', e => { 
        if(!galContainer.isDown) return;
        targetScroll += (galContainer.startX - e.touches[0].clientX) * 0.05;
        galContainer.startX = e.touches[0].clientX;
    });

    function updateOGL() {
        scroll = scroll + (targetScroll - scroll) * 0.05;
        medias.forEach(m => {
            let x = (m.i * 9) - scroll;
            const totalWidth = mediaData.length * 9;
            while(x < -totalWidth/2) x += totalWidth;
            while(x > totalWidth/2) x -= totalWidth;
            m.mesh.position.x = x;
            m.mesh.position.y = -Math.cos(x * 0.15) * 3 + 3;
            m.mesh.rotation.z = -x * 0.1;
        });
        oglRenderer.render({ scene: oglScene, camera: oglCamera });
        requestAnimationFrame(updateOGL);
    }
    
    function resize() {
        oglRenderer.setSize(galContainer.clientWidth, galContainer.clientHeight);
        oglCamera.perspective({ aspect: gl.canvas.width / gl.canvas.height });
    }
    window.addEventListener('resize', resize); resize();
    updateOGL();

    // Reveal finale when scrolled to bottom
    const mainContent = document.getElementById('mainContent');
    mainContent.addEventListener('scroll', () => {
        if(mainContent.scrollTop + mainContent.clientHeight >= mainContent.scrollHeight - 50) {
            document.getElementById('finale-section').style.display = 'block';
        }
    });
</script>
</body>
</html>
