<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Happy 18th Kashvi! üßøüíô</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script async src="https://unpkg.com/es-module-shims@1.8.0/dist/es-module-shims.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    <style>
        :root { --primary-blue: #00d4ff; --neon-pink: #ffb7c5; --deep-space: #010103; }
        body { margin: 0; padding: 0; background: var(--deep-space); font-family: 'Georgia', serif; color: white; overflow-x: hidden; scroll-behavior: smooth; }

        /* Mobile Responsive Overlay */
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 2000; transition: opacity 1s ease; text-align: center;
            background: radial-gradient(circle at center, #001d3d 0%, #000000 100%);
            padding: 20px; box-sizing: border-box;
        }
        
        #countdown { display: flex; margin: 15px 0; color: var(--primary-blue); font-family: sans-serif; flex-wrap: wrap; justify-content: center; }
        .timer-unit { margin: 5px 10px; }
        .timer-num { font-size: 1.5rem; font-weight: bold; display: block; }

        button {
            padding: 12px 30px; border-radius: 50px; border: none; font-weight: bold;
            letter-spacing: 2px; transition: 0.4s; cursor: pointer;
            background: var(--primary-blue); color: white; box-shadow: 0 0 20px var(--primary-blue);
            font-size: 0.9rem;
        }

        #canvas-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; }
        .content-scroll { position: relative; z-index: 10; width: 100%; display: none; flex-direction: column; align-items: center; }
        
        /* Spacing for mobile vs Desktop */
        .container { text-align: center; padding: 100vh 15px 50px 15px; width: 100%; box-sizing: border-box; }

        /* RESPONSIVE GRID: 2 columns on mobile, 4 on desktop */
        .collage { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 12px; 
            margin: 30px auto; 
            width: 100%; 
            max-width: 1100px;
        }
        
        @media (min-width: 768px) {
            .collage { grid-template-columns: repeat(4, 1fr); gap: 15px; }
        }
        
        .img-card { position: relative; cursor: pointer; text-align: center; display: flex; flex-direction: column; }
        
        .collage img { 
            width: 100%; border-radius: 8px; 
            border: 2px solid rgba(0, 212, 255, 0.2);
            transition: all 0.6s ease; 
            filter: grayscale(100%) brightness(0.4);
            aspect-ratio: 1 / 1;
            object-fit: cover;
        }
        
        .img-card.unlocked img { 
            filter: grayscale(0%) brightness(1.1); 
            border-color: var(--primary-blue); 
            box-shadow: 0 0 10px var(--primary-blue);
        }

        .typewriter-box {
            min-height: 80px; margin-top: 8px; font-size: 0.75rem; line-height: 1.3;
            color: #ffffff; 
            background: rgba(0, 0, 0, 0.85);
            padding: 10px; border-radius: 6px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(0, 212, 255, 0.2);
            text-align: left;
        }

        #bottom-finale {
            opacity: 0; transform: translateY(30px);
            transition: all 1.5s ease;
            margin: 60px 0 20px 0; padding: 20px;
        }
        #bottom-finale.visible { opacity: 1; transform: translateY(0); }

        .birthday-title {
            font-size: 2.2rem; color: var(--primary-blue);
            text-shadow: 0 0 20px var(--primary-blue);
            font-weight: bold; margin-bottom: 15px;
            animation: glowPulse 2s infinite alternate;
        }
        
        @media (min-width: 768px) { .birthday-title { font-size: 3.5rem; } }

        .neon-footer { 
            margin-top: 30px; margin-bottom: 80px;
            text-align: center; line-height: 1.5;
        }
        .line-1, .line-2 {
            font-weight: bold; color: var(--neon-pink); text-transform: uppercase;
            display: block; animation: neonFlicker 4s infinite;
        }
        .line-1 { font-size: 0.8rem; letter-spacing: 2px; margin-bottom: 5px; }
        .line-2 { font-size: 1.2rem; letter-spacing: 1px; }

        @keyframes neonFlicker {
            0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
                opacity: 1;
                text-shadow: 0 0 7px var(--neon-pink), 0 0 15px #ff1493, 0 0 30px #ff1493;
            }
            20%, 22%, 24%, 55% { opacity: 0.6; text-shadow: 0 0 2px var(--neon-pink); }
        }

        .click-hint {
            position: absolute; top: -20px; left: 50%; transform: translateX(-50%);
            background: var(--primary-blue); color: #000; padding: 3px 10px;
            border-radius: 15px; font-size: 0.6rem; font-weight: bold;
            animation: bounce 2s infinite; z-index: 5;
        }
        @keyframes bounce { 0%, 100% { transform: translate(-50%, 0); } 50% { transform: translate(-50%, -8px); } }
    </style>
</head>
<body>

<div id="overlay">
    <div id="countdown">
        <div class="timer-unit"><span class="timer-num" id="days">00</span><span>Days</span></div>
        <div class="timer-unit"><span class="timer-num" id="hours">00</span><span>Hrs</span></div>
        <div class="timer-unit"><span class="timer-num" id="mins">00</span><span>Mins</span></div>
        <div class="timer-unit"><span class="timer-num" id="secs">00</span><span>Secs</span></div>
    </div>
    <button id="entryBtn">OPEN KASHVI'S GIFT üíô</button>
</div>

<div id="canvas-container"></div>

<div class="content-scroll" id="mainContent">
    <div class="container">
        <h1 style="color: var(--primary-blue); font-size: 1.5rem; letter-spacing: 2px;">FOR KASHVI üßø</h1>
        <p style="opacity: 0.7; font-size: 0.9rem; margin-bottom: 30px;">Tap photos to reveal memories</p>
        
        <div class="collage">
            <div class="img-card" onclick="typeWriterReveal(this, 0)"><div class="click-hint">START ü§ç</div><img src="1.jpeg"><div class="typewriter-box" id="text-0"></div></div>
            <div class="img-card" onclick="typeWriterReveal(this, 1)"><img src="2.jpeg"><div class="typewriter-box" id="text-1"></div></div>
            <div class="img-card" onclick="typeWriterReveal(this, 2)"><img src="7.jpeg"><div class="typewriter-box" id="text-2"></div></div>
            <div class="img-card" onclick="typeWriterReveal(this, 3)"><img src="8.jpeg"><div class="typewriter-box" id="text-3"></div></div>
            <div class="img-card" onclick="typeWriterReveal(this, 4)"><img src="9.jpeg"><div class="typewriter-box" id="text-4"></div></div>
            <div class="img-card" onclick="typeWriterReveal(this, 5)"><img src="10.jpeg"><div class="typewriter-box" id="text-5"></div></div>
            <div class="img-card" onclick="typeWriterReveal(this, 6)"><img src="5.jpeg"><div class="typewriter-box" id="text-6"></div></div>
            <div class="img-card" onclick="typeWriterReveal(this, 7)"><img src="6.jpeg"><div class="typewriter-box" id="text-7"></div></div>
        </div>

        <div id="bottom-finale">
            <div class="birthday-title">HAPPY BIRTHDAY<br>KASHVI! üßøüíô</div>
            <div class="neon-footer">
                <span class="line-1">FOR THE WINS & THE LAUGHS. üíô</span>
                <span class="line-2">THE BEST IS YET TO COME. üßø</span>
            </div>
        </div>
    </div>
</div>

<audio id="bgMusic" loop><source src="birthday-song.mp3" type="audio/mpeg"></audio>

<script>
    const messages = [
        "Happy Birthday! It‚Äôs been great having someone so reliable to navigate the daily grind with. ü§ù",
        "From lab sessions to sharing earphones, thanks for making the long hours much more manageable. üß™",
        "I really value the healthy competition we have. You definitely keep me on my toes. üìà",
        "Grateful for the times you've had my back quietly. It hasn't gone unnoticed. ü´Ç",
        "Here's to all the random laughs that helped us get through the stressful days. üòÇ",
        "I admire your strength when things get tough. Glad to be on this journey with you. ‚ú®",
        "Enjoy your 18th! It's a big milestone, and I know you're going to achieve great things. üßø",
        "Genuinely glad for this bond. Looking forward to more wins and successful projects ahead. üíô"
    ];

    let unlockedCount = 0;
    function typeWriterReveal(card, index) {
        if(card.classList.contains('unlocked')) return;
        card.classList.add('unlocked');
        unlockedCount++;
        const hint = card.querySelector('.click-hint'); if(hint) hint.style.display = 'none';

        const targetDiv = document.getElementById(`text-${index}`);
        const text = messages[index];
        let i = 0;
        function type() {
            if (i < text.length) {
                targetDiv.innerHTML += text.charAt(i); i++; setTimeout(type, 35);
            } else if (unlockedCount === 8) {
                const f = document.getElementById('bottom-finale');
                f.classList.add('visible');
                setTimeout(() => { f.scrollIntoView({ behavior: 'smooth' }); confetti({ particleCount: 100, spread: 60, origin: { y: 0.8 } }); }, 800);
            }
        }
        type();
        confetti({ particleCount: 15, spread: 40, colors: ['#00d4ff'] });
    }

    const targetDate = new Date("January 20, 2026 00:00:00").getTime();
    function updateCountdown() {
        const dist = targetDate - new Date().getTime();
        document.getElementById("days").innerText = String(Math.max(0, Math.floor(dist / 86400000))).padStart(2, '0');
        document.getElementById("hours").innerText = String(Math.max(0, Math.floor((dist % 86400000) / 3600000))).padStart(2, '0');
        document.getElementById("mins").innerText = String(Math.max(0, Math.floor((dist % 3600000) / 60000))).padStart(2, '0');
        document.getElementById("secs").innerText = String(Math.max(0, Math.floor((dist % 60000) / 1000))).padStart(2, '0');
    }
    setInterval(updateCountdown, 1000); updateCountdown();

    document.getElementById('entryBtn').addEventListener('click', () => {
        document.getElementById('overlay').style.opacity = '0';
        setTimeout(() => {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('mainContent').style.display = 'flex';
        }, 1000);
        document.getElementById('bgMusic').play();
    });
</script>

<script type="module">
    import * as THREE from 'three';
    import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
    import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
    import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    camera.position.z = 25;
    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); // Performance boost
    document.getElementById('canvas-container').appendChild(renderer.domElement);

    const composer = new EffectComposer(renderer);
    composer.addPass(new RenderPass(scene, camera));
    composer.addPass(new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.2, 0.4, 0.85));

    const PARTICLE_COUNT = window.innerWidth < 768 ? 8000 : 15000; // Fewer particles on mobile
    const geometry = new THREE.BufferGeometry();
    const pos = new Float32Array(PARTICLE_COUNT * 3);
    const targetArr = new Float32Array(PARTICLE_COUNT * 3);

    for(let i=0; i<PARTICLE_COUNT; i++) {
        pos[i*3] = (Math.random()-0.5)*80; pos[i*3+1] = (Math.random()-0.5)*80; pos[i*3+2] = (Math.random()-0.5)*80;
    }
    geometry.setAttribute('position', new THREE.BufferAttribute(pos, 3));
    const particles = new THREE.Points(geometry, new THREE.PointsMaterial({ size: 0.12, color: 0x00d4ff, blending: THREE.AdditiveBlending }));
    scene.add(particles);

    let mx = 0, my = 0;
    window.addEventListener('touchmove', (e) => {
        mx = (e.touches[0].clientX - window.innerWidth/2) / 2000;
        my = (e.touches[0].clientY - window.innerHeight/2) / 2000;
    });
    window.addEventListener('mousemove', (e) => { 
        mx = (e.clientX - window.innerWidth/2) / 1500; 
        my = (e.clientY - window.innerHeight/2) / 1500; 
    });

    let shapeIdx = 0;
    function morph() {
        const scale = window.innerWidth < 768 ? 8 : 12; // Smaller shapes on mobile
        for(let i=0; i<PARTICLE_COUNT; i++) {
            const i3 = i*3; const t = (i/PARTICLE_COUNT) * Math.PI * 2;
            let x, y, z;
            if (shapeIdx === 0) { // Infinity
                x = (scale * Math.cos(t)) / (1 + Math.pow(Math.sin(t), 2)); y = (scale * Math.sin(t) * Math.cos(t)) / (1 + Math.pow(Math.sin(t), 2)); z = (Math.random()-0.5) * 2;
            } else if (shapeIdx === 1) { // Heart
                x = 16 * Math.pow(Math.sin(t), 3) * (scale/20); y = (13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t)) * (scale/20); z = (Math.random()-0.5) * 2;
            } else if (shapeIdx === 2) { // DNA
                x = Math.cos(t * 10) * (scale/2); z = Math.sin(t * 10) * (scale/2); y = (i/PARTICLE_COUNT)*30 - 15;
            } else { // Sphere
                const phi = Math.acos(-1 + (2 * i) / PARTICLE_COUNT); const theta = Math.sqrt(PARTICLE_COUNT * Math.PI) * phi; x = scale * Math.cos(theta) * Math.sin(phi); y = scale * Math.sin(theta) * Math.sin(phi); z = scale * Math.cos(phi);
            }
            targetArr[i3] = x; targetArr[i3+1] = y; targetArr[i3+2] = z;
        }
        shapeIdx = (shapeIdx + 1) % 4;
    }

    function animate() {
        requestAnimationFrame(animate);
        const p = geometry.attributes.position.array;
        for(let i=0; i<PARTICLE_COUNT*3; i++) p[i] += (targetArr[i] - p[i]) * 0.04;
        particles.rotation.y += 0.001 + mx;
        particles.rotation.x += my;
        geometry.attributes.position.needsUpdate = true;
        composer.render();
    }
    morph(); animate();
    setInterval(morph, 6000);
</script>
</body>
</html>
